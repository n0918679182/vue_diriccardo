import{d as E,e as i,S as _,_ as S,f as u,m as f,r as k,o as r,c as l,b as w,a as e,F as m,g as v,j as B,t as p,h as O,l as I,p as C,k as L}from"./index-a4e33d3d.js";import{c as T}from"./cartStore-34ded66f.js";const y=E("eventStore",{state:()=>({events:[],tempEvent:{},tempBr:{subTitle:[],detail:[]}}),actions:{getEvents(){i.get("https://diriccardo-server.onrender.com/event").then(t=>{this.events=t.data}).catch(t=>alert(t.response.data.message))},getEvent(t){this.tempEvent=t,this.tempBr.subTitle=this.tempEvent.subTitle.split(`
`),this.tempBr.detail=this.tempEvent.detail.split(`
`)},async addToOrder(){const{randomOrderId:t}=T();let n=!1,h=0,b=0;const o={orders:[]};o.tableId=localStorage.getItem("tableId"),o.staffId=localStorage.getItem("staffId"),o.time=new Date,o.subtotal=this.tempEvent.price;const g=t();o.serial=g,o.user=0,o.orders.push(this.tempEvent.productNum),await i.get("https://diriccardo-server.onrender.com/orderList").then(a=>{a.data.forEach(s=>{s.tableId==localStorage.getItem("tableId")?(n=!0,h=s.id,b=s.subtotal,s.orders.forEach(d=>{o.orders.push(d)})):localStorage.getItem("orderId")||localStorage.setItem("orderId",a.data.length)})}),n?i.patch("https://diriccardo-server.onrender.com/orderList/"+h,{orders:o.orders,subtotal:b+o.subtotal}).then(a=>{document.getElementById("checkOrderClose").click(),_.fire({icon:"success",title:"餐點已送出",showConfirmButton:!1,timer:1500})}).catch(a=>alert(a.response.data.message)):(i.post("https://diriccardo-server.onrender.com/orderList",o).then(a=>{document.getElementById("checkOrderClose").click(),_.fire({icon:"success",title:"餐點已送出",showConfirmButton:!1,timer:1500})}).catch(a=>alert(a.response.data.message)),i.get("https://diriccardo-server.onrender.com/tableState").then(a=>{let s;s=a.data.filter(d=>d.tableId==localStorage.getItem("tableId"))[0].id,i.patch("https://diriccardo-server.onrender.com/tableState/"+s,{orderSerial:g}).catch(d=>alert(d.response.data.message))}))}}}),V="/vue_diriccardo/assets/ordered-bg1-682d8135.png",M="/vue_diriccardo/assets/ordered-bg2-76e01605.png";const N={computed:{...u(y,["events","tempEvent","tempBr"]),...u(I,["isLoading"])},methods:{...f(y,["getEvents","getEvent","addToOrder"]),...f(I,["loading"])},mounted(){this.getEvents(),this.loading()}},c=t=>(C("data-v-5f480f68"),t=t(),L(),t),$={class:"event w-100 pt-4 overflow-hidden position-relative vh-100"},x=c(()=>e("img",{src:V,class:"eventBg_img1",alt:""},null,-1)),U=c(()=>e("img",{src:M,class:"eventBg_img2",alt:""},null,-1)),z={class:"container mt-20 pt-4"},D={class:"bg-event row rounded-2 p-4 border border-white"},F=["onClick"],j=["src"],A={class:"modal fade",id:"eventModal",tabindex:"-1","aria-labelledby":"eventModallLabel","aria-hidden":"true"},q={class:"modal-dialog modal-lg modal-dialog-centered"},G={class:"modal-content position-relative"},H={class:"modal-body row"},J=c(()=>e("button",{type:"button",style:{"z-index":"20"},class:"btn-close position-absolute top-0 end-0 me-6 mt-3","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),K={class:"col-4 p-3"},P=["src"],Q={key:0,class:"btn btn-outline-dark btn-sm",style:{width:"233px"},type:"bottom","data-bs-toggle":"modal","data-bs-target":"#checkOrderModal"},R={class:"col-8 p-3"},W={class:"h5 fw-bold mb-3"},X={class:"border-start border-3 border-dark ms-1 mb-4 ps-2"},Y=c(()=>e("h3",{class:"h5 mb-3 fw-bolder"},"活動資訊",-1)),Z={class:"border-start border-3 border-dark ms-1 mb-4 ps-2"},ee={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:"checkOrderModal",tabindex:"-1","aria-labelledby":"checkOrderModalLabel","aria-hidden":"true"},te={class:"modal-dialog modal-dialog-centered"},se={class:"modal-content"},oe={class:"modal-body text-center pt-10"},ae={class:"text-danger"},de=c(()=>e("p",null,"確定點購嗎？",-1)),re={class:"modal-footer"},le=c(()=>e("button",{type:"button",class:"btn btn-outline-danger","data-bs-target":"#eventModal","data-bs-toggle":"modal",id:"checkOrderClose"},"取消",-1));function ne(t,n,h,b,o,g){const a=k("VueLoading");return r(),l(m,null,[w(a,{active:t.isLoading,"onUpdate:active":n[0]||(n[0]=s=>t.isLoading=s)},null,8,["active"]),e("div",$,[x,U,e("div",z,[e("div",D,[(r(!0),l(m,null,v(t.events,s=>(r(),l("div",{class:"col-4",key:s.id},[e("div",{class:"w-100",style:{height:"450px"},"data-bs-toggle":"modal","data-bs-target":"#eventModal",onClick:d=>t.getEvent(s)},[e("img",{src:s.imgUrl,alt:"",class:"img-fluid"},null,8,j)],8,F)]))),128))])])]),e("div",A,[e("div",q,[e("div",G,[e("div",H,[J,e("div",K,[e("img",{src:t.tempEvent.imgUrl,alt:"",class:"img-fluid mb-3"},null,8,P),t.tempEvent.type=="productSell"?(r(),l("button",Q," 我要點餐")):B("",!0)]),e("div",R,[e("h2",W,p(t.tempEvent.title),1),e("div",X,[(r(!0),l(m,null,v(t.tempBr.subTitle,s=>(r(),l("p",{key:s,class:"mb-0 h7"},p(s),1))),128))]),Y,e("div",Z,[(r(!0),l(m,null,v(t.tempBr.detail,(s,d)=>(r(),l("p",{key:d,class:"mb-0",style:{"font-size":"14px","max-width":"450px"}},p(s),1))),128))])])])])])]),e("div",ee,[e("div",te,[e("div",se,[e("div",oe,[e("p",null,[O("即將點購 "),e("span",ae,p(t.tempEvent.title),1)]),de]),e("div",re,[le,e("button",{type:"button",class:"btn btn-danger",onClick:n[1]||(n[1]=(...s)=>t.addToOrder&&t.addToOrder(...s))},"確定")])])])])],64)}const me=S(N,[["render",ne],["__scopeId","data-v-5f480f68"]]);export{me as default};
