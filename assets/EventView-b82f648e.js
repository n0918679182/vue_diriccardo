import{d as u,e as r,_ as f,f as I,m as y,o as d,c as l,a as t,F as m,g,j as E,t as p,h as k,p as S,k as w}from"./index-0ddc5a92.js";import{c as B}from"./cartStore-de6b5cf6.js";const v=u("eventStore",{state:()=>({events:[],tempEvent:{},tempBr:{subTitle:[],detail:[]}}),actions:{getEvents(){r.get("http://localhost:3000/event").then(e=>{this.events=e.data}).catch(e=>alert(e.response.data.message))},getEvent(e){this.tempEvent=e,this.tempBr.subTitle=this.tempEvent.subTitle.split(`
`),this.tempBr.detail=this.tempEvent.detail.split(`
`)},async addToOrder(){const{randomOrderId:e}=B();let i=!1,h=0,b=0;const a={orders:[]};a.tableId=localStorage.getItem("tableId"),a.staffId=localStorage.getItem("staffId"),a.time=new Date,a.subtotal=this.tempEvent.price;const _=e();a.serial=_,a.user=0,a.orders.push(this.tempEvent.productNum),await r.get("http://localhost:3000/orderList").then(s=>{s.data.forEach(o=>{o.tableId==localStorage.getItem("tableId")?(i=!0,h=o.id,b=o.subtotal,o.orders.forEach(c=>{a.orders.push(c)})):localStorage.getItem("orderId")||localStorage.setItem("orderId",s.data.length)})}),i?r.patch("http://localhost:3000/orderList/"+h,{orders:a.orders,subtotal:b+a.subtotal}).then(s=>{document.getElementById("checkOrderClose").click(),alert("餐點已送出")}).catch(s=>alert(s.response.data.message)):(r.post("http://localhost:3000/orderList",a).then(s=>{document.getElementById("checkOrderClose").click(),alert("餐點已送出")}).catch(s=>alert(s.response.data.message)),r.get("http://localhost:3000/tableState").then(s=>{let o;o=s.data.filter(c=>c.tableId==localStorage.getItem("tableId"))[0].id,r.patch("http://localhost:3000/tableState/"+o,{orderSerial:_}).catch(c=>alert(c.response.data.message))}))}}}),O="/vue_diriccardo/assets/ordered-bg1-682d8135.png",T="/vue_diriccardo/assets/ordered-bg2-76e01605.png";const C={computed:{...I(v,["events","tempEvent","tempBr"])},methods:{...y(v,["getEvents","getEvent","addToOrder"])},mounted(){this.getEvents()}},n=e=>(S("data-v-6bcedf55"),e=e(),w(),e),M={class:"event w-100 pt-4 overflow-hidden position-relative vh-100"},x=n(()=>t("img",{src:O,class:"eventBg_img1",alt:""},null,-1)),L=n(()=>t("img",{src:T,class:"eventBg_img2",alt:""},null,-1)),V={class:"container mt-20 pt-4"},$={class:"bg-event row rounded-2 p-4 border border-white"},N=["onClick"],z=["src"],D={class:"modal fade",id:"eventModal",tabindex:"-1","aria-labelledby":"eventModallLabel","aria-hidden":"true"},F={class:"modal-dialog modal-lg modal-dialog-centered"},U={class:"modal-content position-relative"},j={class:"modal-body row"},A=n(()=>t("button",{type:"button",style:{"z-index":"20"},class:"btn-close position-absolute top-0 end-0 me-6 mt-3","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),q={class:"col-4 p-3"},G=["src"],H={key:0,class:"btn btn-outline-dark btn-sm",style:{width:"233px"},type:"bottom","data-bs-toggle":"modal","data-bs-target":"#checkOrderModal"},J={class:"col-8 p-3"},K={class:"h5 fw-bold mb-3"},P={class:"border-start border-3 border-dark ms-1 mb-4 ps-2"},Q=n(()=>t("h3",{class:"h5 mb-3 fw-bolder"},"活動資訊",-1)),R={class:"border-start border-3 border-dark ms-1 mb-4 ps-2"},W={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:"checkOrderModal",tabindex:"-1","aria-labelledby":"checkOrderModalLabel","aria-hidden":"true"},X={class:"modal-dialog modal-dialog-centered"},Y={class:"modal-content"},Z={class:"modal-body text-center pt-10"},tt={class:"text-danger"},et=n(()=>t("p",null,"確定點購嗎？",-1)),st={class:"modal-footer"},at=n(()=>t("button",{type:"button",class:"btn btn-outline-danger","data-bs-target":"#eventModal","data-bs-toggle":"modal",id:"checkOrderClose"},"取消",-1));function ot(e,i,h,b,a,_){return d(),l(m,null,[t("div",M,[x,L,t("div",V,[t("div",$,[(d(!0),l(m,null,g(e.events,s=>(d(),l("div",{class:"col-4",key:s.id},[t("div",{class:"w-100",style:{height:"450px"},"data-bs-toggle":"modal","data-bs-target":"#eventModal",onClick:o=>e.getEvent(s)},[t("img",{src:s.imgUrl,alt:"",class:"img-fluid"},null,8,z)],8,N)]))),128))])])]),t("div",D,[t("div",F,[t("div",U,[t("div",j,[A,t("div",q,[t("img",{src:e.tempEvent.imgUrl,alt:"",class:"img-fluid mb-3"},null,8,G),e.tempEvent.type=="productSell"?(d(),l("button",H," 我要點餐")):E("",!0)]),t("div",J,[t("h2",K,p(e.tempEvent.title),1),t("div",P,[(d(!0),l(m,null,g(e.tempBr.subTitle,s=>(d(),l("p",{key:s,class:"mb-0 h7"},p(s),1))),128))]),Q,t("div",R,[(d(!0),l(m,null,g(e.tempBr.detail,(s,o)=>(d(),l("p",{key:o,class:"mb-0",style:{"font-size":"14px","max-width":"450px"}},p(s),1))),128))])])])])])]),t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[t("p",null,[k("即將點購 "),t("span",tt,p(e.tempEvent.title),1)]),et]),t("div",st,[at,t("button",{type:"button",class:"btn btn-danger",onClick:i[0]||(i[0]=(...s)=>e.addToOrder&&e.addToOrder(...s))},"確定")])])])])],64)}const rt=f(C,[["render",ot],["__scopeId","data-v-6bcedf55"]]);export{rt as default};
